<!DOCTYPE html>
<html>
<head>
<title>ENDY</title>
<meta name="viewport" content="initial-scale=1, width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="./css/main.css" \>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" \>
<link rel="icon" href="/assets/sprite.png"/>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
</head>
<body>
    
<div class="logo-container">
    <nav role="navigation">
        <div id="menuToggle">
            <input type="checkbox" />
            <span></span>
            <span></span>
            <span></span>

            <ul id="menu">
              <a href="#"><li>Home</li></a>
              <a href="#"><li>About</li></a>
              <a href="#"><li>Info</li></a>
              <a href="#"><li>Contact</li></a>
              <a href="https://github.com/Kralexe/ENDY" target="_blank"><li>Show me the code</li></a>
            </ul>
        </div>
    </nav>
	<div class="title">
		ФРАНШИЗА
	</div>
</div>
    
<div class="header">
	<section class="openrest">
		<div class="frank"><h2>Откройте свой<br id="hidden1" /> ресторан</h2></div>
		<div class="blahblah"><p>Диониссийское начало по определению вызывает самодостаточный эдипов комплекс. Добавлю, что филогенез продолжает персональный эдипов комплекс, что-то подобное можно встретить в работах Ауэрбаха и Тандлера. Этикет, как бы это не казалось парадоксальным, традиционен.</p>
		</div>	
	</section>
</div>

<div class="white-block">
	<div class="description-container">
		<div class="description-item">
			<h2>2014</h2><p class="border">год основания компании</p>
		</div>
		<div class="description-item">
			<h2>2016</h2><p class="border">год запуска франчайзинга</p>
		</div>
		<div class="description-item">
			<h2>1</h2><p class="border">франшизных преприятий</p>
		</div>
		<div class="description-item">
			<h2>5</h2><p class="border">собственных предприятий</p>
		</div>
	</div>
</div>

<div class="offer">
    <div class="vertical-wrap">
        <h2>Что мы предлагаем</h2>
        <ul class="info-list">
        <li><div>1</div>Передача оптимизированных бизнес-процессов</li>
        <li><div>2</div>Приезд на открытие стартап-команды франчайзи</li>
        <li><div>3</div>Программа обучения и тренинги для персонала</li>
        <li><div>4</div>Оперативная поддержка и консультации</li>
        <li><div>5</div>Топ-менеджмент на базе флагманского ресторана</li>
        <li><div>6</div>Маркетинговая концепция с учётом вашей <br id="hidden" /> геолокации</li>
        <li><div>7</div>Внедрение в общую SMM-компанию</li>
        <li><div>8</div>Актуальные меню, карты бара и <br id="hidden" /> макеты полиграфических материалов</li>
        <li><div>9</div>Обновление фоновой музыки и видеоряда</li>
        </ul>
        <a href="#" >Посмотреть полное описание на beboss.ru&nbsp;<i class="fa fa-long-arrow-right" style="font-size:14px"></i></a>
        <a href="#">Скачать презентацию (PDF, 1.2 МБ)&nbsp;&nbsp;<i class="fa fa-long-arrow-right" style="font-size:14px"></i></a>
    </div>
</div>
    
<div class="black-block">
    <h2 class="condi">Условия франшизы</h2>
	<div class="descri">
		<div class="descri-item">
            <h3>500 <span>тыс. руб.</span></h3><p class="border">вступительный взнос</p>
		</div>
		<div class="descri-item">
            <h3>6<span>%</span></h3><p class="border">роялти в 1-ый год (первые 2 месяца с открытия, мораторий на выплату роялти)</p>
		</div>
		<div class="descri-item">
			<h3>8<span>%</span></h3><p class="border">роялти со 2-го года</p>
		</div>
	</div>
</div>

<div class="formdiv">
    <h2>открыть свой ресторан</h2>
    <div class="form" action="/">
        <form id="myForm" \>
  
        <input type="text" name="firstname" placeholder="Имя" \>
        <br \>
        <input type="text" name="phone" placeholder="Контактный телефон" \>
        <br \>
        <input type="text" name="email" placeholder="Электронная почта" \>
        <br \>
        <input type="text" name="city" placeholder="Город открытия" \>
        <br \>
        <input type="text" name="message" placeholder="Сообщение" \>
        <br \>
        <img src="assets/gotcha.png" \>
        <input type="submit" value="Отправить заявку" \>
        <p>Нажимая кнопку "Отправить заявку", вы даёте согласие на обработку своих персональных данных</p>        
        </form> 
    </div>
</div>

<div class="footer">
    <div class="contacts">
        <a href="tel:+88007777777"><span class="icon-1"></span>8 800 777-77-77</a>
        <a id="greyish" href="mailto:info@rest.ru"><span class="icon-2"></span>info@rest.ru</a>
    </div>
    <hr \>
    <div class="navigation-bar">
        <a href="#">Рестораны</a>
        <a href="#">Что в меню</a>
        <a href="#">Акции и события</a>
        <a href="#">О нас</a>
        <a href="#">Франшиза</a>
        <a href="#">Контакты</a>
    </div>
    <div class="navigation-bar320">
        <div class="left">
            <a href="#">Рестораны</a>
            <a href="#">Что в меню</a>
            <a href="#">Акции и события</a>
        </div>
        <div class="right">
            <a href="#">О нас</a>
            <a href="#">Франшиза</a>
            <a href="#">Контакты</a>
        </div>
    </div>
    <hr \>
    <div class="socialmedias">
        <div id="right-border"><span class="icon-3"></span></div>
        <div id="right-border"><span class="icon-4"></span></div>
        <div id="right-border"><span class="icon-5"></span></div>
        <div id="right-border"><span class="icon-6"></span></div>
        <div><span class="icon-7"></span></div>
    </div>
    <hr \>
    <div class="privacystatement">Политика конфиденциальности</div>
</div>

<script>
/*Это для sticky menu на широких экранах*/
window.onscroll = function() {myFunction()};
var header = document.getElementsByClassName("logo-container")[0];
var title = document.getElementsByClassName("title")[0];
var sticky = title.offsetParent.offsetTop;
function myFunction() {
  if (window.pageYOffset > sticky) {
    header.classList.add("sticky");
  } else {
    header.classList.remove("sticky");
  }
};

//Тут идет валидация данных формы, их отправка на сервер, а потом возврат
//если успех, то всплывет сексесс поп-ап на 3 секунды (можно убрать досрочно кликом вне него), если нет, то вылезет ошибка
//все поля должны быть заполнены и соответствовать регексам, пайпы и бектики запрещены
const myForm = document.getElementById('myForm');
const inputs = myForm.getElementsByTagName('input');

myForm.addEventListener('submit', function (e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const name = /[\u0400-\u04FFa-zA-Z0-9][^#&<>`|\"~;$^%{}?]{1,20}$/;
    const number = /^(\+7|7|8)?[\s\-]?\(?[489][0-9]{2}\)?[\s\-]?[0-9]{3}[\s\-]?[0-9]{2}[\s\-]?[0-9]{2}$/;
    const email = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    const message = /[\u0400-\u04FFa-zA-Z0-9][^`|]{1,20}$/;
    [...spread] = formData.entries();
    const json = {};
    for (let i=0; i<5; i++){
        json[spread[i][0]] = spread[i][1];
    }
    
    //если поля заполнены и выдают тру при тесте на соответствие нужному регексу
    if (name.test(spread[0][1]) && number.test(spread[1][1]) && email.test(spread[2][1]) && name.test(spread[3][1]) && message.test(spread[4][1])) {
    //запрос идет на рут и обратно отправляется тот же JSON объект, выводится в консольку
    fetch('http://localhost:3000/', {
        headers: {"Content-Type": "application/json"},
        method: 'post',
        body: JSON.stringify(json)
    }).then(function (response) {
        console.log(response.text());
        myForm.reset();})
    .then(function(){
        Swal.fire({
          position: 'top-end',
          type: 'success',
          title: 'Сообщение отправлено',
          showConfirmButton: false,
          timer: 3000
        })
    }).catch(function (error) {
        console.error(error);
    })}
    else {
        Swal.fire({
          type: 'error',
          title: 'Oops...',
          text: 'Нам нужны достоверные данные',
          footer: 'Дозаполните форму либо перепроверьте её'
        })
    }
});
</script>
</body>
</html>